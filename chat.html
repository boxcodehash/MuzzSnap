<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>MuzzSnap - Secure Edition</title>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Orbitron:wght@900&display=swap');
    
    * { -webkit-tap-highlight-color: transparent; }
    
    :root { 
      --bg-dark: radial-gradient(circle at center, #1a0505 0%, #050505 100%);
      --bg-light: #f1f5f9;
    }

    body { 
      margin: 0; 
      padding: 0; 
      overflow: hidden;
      font-family: 'Fira Code', monospace;
    }
    
    body.theme-dark { 
      background: var(--bg-dark); 
      color: #fff; 
    }
    
    body.theme-light { 
      background: var(--bg-light); 
      color: #0f172a; 
    }

    .card-3d { 
      backdrop-filter: blur(20px); 
      transition: all 0.4s ease; 
      border-radius: 28px; 
    }
    
    .theme-dark .card-3d { 
      background: rgba(12, 4, 4, 0.95); 
      border: 1px solid rgba(255, 0, 0, 0.2); 
      box-shadow: 0 15px 40px rgba(0,0,0,0.7); 
    }
    
    .theme-light .card-3d { 
      background: rgba(255, 255, 255, 0.98); 
      border: 1px solid #e2e8f0; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.06); 
    }

    .bubble-3d { 
      border-radius: 18px; 
      padding: 12px 18px; 
      margin: 4px 0; 
      max-width: 85%; 
      font-size: 14px; 
      word-wrap: break-word;
      word-break: break-word;
    }
    
    .theme-dark .bubble-3d.me { 
      background: linear-gradient(145deg, #ff0000, #990000); 
      color: white; 
    }
    
    .theme-dark .bubble-3d.other { 
      background: #222; 
      color: #eee; 
    }
    
    .theme-light .bubble-3d.me { 
      background: #0f172a; 
      color: #fff; 
    }
    
    .theme-light .bubble-3d.other { 
      background: #fff; 
      color: #0f172a; 
      border: 1px solid #e2e8f0; 
    }

    .admin-glow { 
      color: #ffcc00; 
      text-shadow: 0 0 8px rgba(255, 204, 0, 0.5); 
      font-weight: 900 !important; 
    }
    
    .emoji-picker { 
      position: absolute; 
      bottom: 85px; 
      left: 50%;
      transform: translateX(-50%);
      width: min(320px, 90vw);
      max-height: 300px; 
      overflow-y: auto; 
      z-index: 200; 
      border-radius: 20px; 
      padding: 15px; 
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(36px, 1fr)); 
      gap: 8px; 
      font-size: 1.4rem; 
    }
    
    .theme-toggle { 
      width: 46px; 
      height: 22px; 
      background: #333; 
      border-radius: 20px; 
      position: relative; 
      cursor: pointer; 
      flex-shrink: 0;
    }
    
    .theme-toggle .circle { 
      width: 16px; 
      height: 16px; 
      background: white; 
      border-radius: 50%; 
      position: absolute; 
      top: 3px; 
      left: 4px; 
      transition: 0.3s; 
    }
    
    .theme-light .theme-toggle { 
      background: #ff0000; 
    }
    
    .theme-light .theme-toggle .circle { 
      left: 26px; 
    }

    .alert-banner { 
      background: #ff0000; 
      color: white; 
      padding: 12px; 
      text-align: center; 
      font-size: 11px; 
      font-weight: 900; 
      animation: flash 1s infinite; 
      z-index: 100;
      letter-spacing: 0.1em;
    }
    
    @keyframes flash { 
      0%, 100% { opacity: 1; } 
      50% { opacity: 0.7; } 
    }

    .sidebar-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 140;
      backdrop-filter: blur(4px);
    }

    @media (max-width: 1023px) {
      .bubble-3d {
        font-size: 13px;
        padding: 10px 14px;
      }
    }

    .scroll-container {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 0, 0, 0.3) transparent;
    }

    .scroll-container::-webkit-scrollbar {
      width: 6px;
    }

    .scroll-container::-webkit-scrollbar-track {
      background: transparent;
    }

    .scroll-container::-webkit-scrollbar-thumb {
      background: rgba(255, 0, 0, 0.3);
      border-radius: 10px;
    }
  </style>
</head>
<body class="theme-dark">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const firebaseConfig = {
      apiKey: "AIzaSyAe1-JfNde0NKIMdE7phfEXlm9JaqUH0jY",
      authDomain: "pulsari.firebaseapp.com",
      databaseURL: "https://pulsari-default-rtdb.firebaseio.com",
      projectId: "pulsari",
      storageBucket: "pulsari.firebasestorage.app",
      messagingSenderId: "824306321233",
      appId: "1:824306321233:web:2c9bfa02170a17d560b570"
    };

    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();

    // HASHES DE WALLETS ADMINISTRATIVAS (SHA-256)
    // Para generar un nuevo hash: Abre consola y ejecuta login, copia el hash mostrado
    const ADMIN_WALLETS = {
      "f501869e5d48a58ec2f92f988849b79410313f8d3885d51940bc27599c9339e0": "Ryachu",
      "819c961c022883f3e18a8008e43e26458519e48c1e4c70308009696987c8801d": "Itsuki"
    };

    const EMOJI_LIST = ["üòÄ","üòÉ","üòÑ","üòÅ","üòÜ","üòÖ","üòÇ","ü§£","üòä","üòá","üôÇ","üôÉ","üòâ","üòå","üòç","ü•∞","üòò","üòó","üòô","üòö","üòã","üòõ","üòù","üòú","ü§™","ü§®","üßê","ü§ì","üòé","ü§©","ü•≥","üòè","üòí","üòû","üòî","üòü","üòï","üôÅ","‚òπÔ∏è","üò£","üòñ","üò´","üò©","ü•∫","üò¢","üò≠","üò§","üò†","üò°","ü§¨","ü§Ø","üò≥","ü•µ","ü•∂","üò±","üò®","üò∞","üò•","üòì","ü§ó","ü§î","ü§≠","ü§´","ü§•","üò∂","üòê","üòë","üò¨","üôÑ","üòØ","üò¶","üòß","üòÆ","üò≤","ü•±","üò¥","ü§§","üò™","üòµ","ü§ê","ü•¥","ü§¢","ü§Æ","ü§ß","üò∑","ü§í","ü§ï","ü§ë","ü§†","üòà","üëø","üëπ","üë∫","ü§°","üëª","üíÄ","‚ò†Ô∏è","üëΩ","üëæ","ü§ñ","üéÉ","üò∫","üò∏","üòπ","üòª","üòº","üòΩ","üôÄ","üòø","üòæ","üëã","ü§ö","üñêÔ∏è","‚úã","üññ","üëå","ü§å","ü§è","‚úåÔ∏è","ü§û","ü§ü","ü§ò","ü§ô","üëà","üëâ","üëÜ","üñï","üëá","‚òùÔ∏è","üëç","üëé","‚úä","üëä","ü§õ","ü§ú","üëè","üôå","üëê","ü§≤","ü§ù","üôè","üí™","ü¶æ","ü¶ø","ü¶µ","ü¶∂","üëÇ","ü¶ª","üëÉ","üß†","ü´Ä","ü´Å","ü¶∑","ü¶¥","üëÄ","üëÅÔ∏è","üëÖ","üëÑ","üíã","ü©∏","‚ù§Ô∏è","üß°","üíõ","üíö","üíô","üíú","üñ§","ü§ç","ü§é","üíî","‚ù£Ô∏è","üíï","üíû","üíì","üíó","üíñ","üíò","üíù","üî•","‚ú®","üí´","‚≠ê","üåü","‚ú¥Ô∏è","‚ö°","üí•","üíØ","üöÄ","üéØ","üé™","üé®","üé≠","üé™","üé§","üéß","üéº","üéπ","ü•Å","üé∑","üé∫","üé∏","ü™ï","üéª","üé≤","‚ôüÔ∏è","üéÆ","üïπÔ∏è","üé∞","üß©"];

    function App() {
      const [user, setUser] = useState(null);
      const [isDark, setIsDark] = useState(localStorage.getItem('theme') !== 'light');
      const [chan, setChan] = useState("spanish");
      const [messages, setMessages] = useState([]);
      const [users, setUsers] = useState([]);
      const [text, setText] = useState("");
      const [alertMsg, setAlertMsg] = useState(null);
      const [showAdminPanel, setShowAdminPanel] = useState(false);
      const [showEmoji, setShowEmoji] = useState(false);
      const [isMenuOpen, setIsMenuOpen] = useState(false);
      const scrollRef = useRef();
      const inputRef = useRef();

      useEffect(() => {
        document.body.className = isDark ? "theme-dark" : "theme-light";
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
      }, [isDark]);

      // Funci√≥n para hashear la wallet de forma segura
      const hashWallet = async (address) => {
        const msgUint8 = new TextEncoder().encode(address.toLowerCase());
        const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
      };

      const login = async () => {
        if (!window.ethereum) {
          alert("‚ö†Ô∏è MetaMask es requerido para acceder");
          return;
        }
        
        try {
          const accs = await window.ethereum.request({ method: 'eth_requestAccounts' });
          const wallet = accs[0].toLowerCase();
          const hashed = await hashWallet(wallet);

          // DEBUG: Mostrar hash en consola para verificaci√≥n
          console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");
          console.log("üîê WALLET HASH:", hashed);
          console.log("üìç WALLET ADDRESS:", wallet);
          console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");

          // Limpieza de sesiones previas
          const snap = await db.ref('presence').orderByChild('wallet').equalTo(wallet).once('value');
          if (snap.exists()) {
            const promises = Object.keys(snap.val()).map(k => db.ref(`presence/${k}`).remove());
            await Promise.all(promises);
          }

          const cred = await auth.signInAnonymously();
          
          // Verificar si es administrador
          const isGod = ADMIN_WALLETS.hasOwnProperty(hashed);
          const adminName = ADMIN_WALLETS[hashed];
          const name = adminName || `Node_${wallet.slice(-4)}`;
          
          console.log("üëë ES ADMINISTRADOR:", isGod);
          console.log("üë§ NOMBRE ASIGNADO:", name);
          console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");
          
          const userData = { 
            uid: cred.user.uid, 
            wallet, 
            name, 
            isGod, 
            color: isGod ? "#ffcc00" : (isDark ? "#ffffff" : "#000000"),
            timestamp: Date.now()
          };
          
          await db.ref(`presence/${cred.user.uid}`).set(userData);
          db.ref(`presence/${cred.user.uid}`).onDisconnect().remove();
          setUser(userData);
          
          if (isGod) {
            console.log("‚úÖ PERMISOS DE ADMINISTRADOR ACTIVADOS");
            console.log("üìã COMANDOS DISPONIBLES:");
            console.log("   /clear - Limpiar chat del sector actual");
            console.log("   /alert [mensaje] - Crear alerta global");
            console.log("   /clearalert - Eliminar alerta global");
            console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");
          }
        } catch (error) {
          console.error("‚ùå Error de autenticaci√≥n:", error);
          alert("Error al conectar con MetaMask");
        }
      };

      useEffect(() => {
        if (!user) return;
        
        const pRef = db.ref(`presence/${user.uid}`);
        pRef.on('value', snap => { 
          if (!snap.exists()) {
            console.log("Sesi√≥n eliminada, recargando...");
            window.location.reload(); 
          }
        });
        
        db.ref('system_alert').on('value', s => setAlertMsg(s.val()));
        
        const mRef = db.ref(`messages/${chan}`).limitToLast(50);
        mRef.on('value', s => {
          const val = s.val();
          setMessages(val ? Object.keys(val).map(k => ({id:k, ...val[k]})).sort((a,b) => a.time - b.time) : []);
        });
        
        db.ref('presence').on('value', s => {
          const data = s.val();
          setUsers(data ? Object.values(data).sort((a,b) => (b.isGod ? 1 : 0) - (a.isGod ? 1 : 0)) : []);
        });
        
        return () => { 
          mRef.off(); 
          db.ref('system_alert').off(); 
          pRef.off(); 
          db.ref('presence').off();
        };
      }, [user, chan]);

      useEffect(() => { 
        scrollRef.current?.scrollIntoView({ behavior: 'smooth' }); 
      }, [messages]);

      const handleSend = async () => {
        const trimmed = text.trim();
        if (!trimmed) return;
        
        // Comandos de administrador (OCULTOS para usuarios normales)
        if (user.isGod) {
          // Comando: Limpiar chat
          if (trimmed === '/clear') {
            try {
              await db.ref(`messages/${chan}`).remove();
              setText("");
              console.log(`‚úÖ [${user.name}] Chat limpiado en sector: ${chan}`);
              return;
            } catch (error) {
              console.error("‚ùå Error al limpiar chat:", error);
              return;
            }
          }
          
          // Comando: Crear alerta
          if (trimmed.startsWith('/alert ')) {
            try {
              const msg = trimmed.substring(7).trim();
              if (msg) {
                await db.ref('system_alert').set(msg);
                setText("");
                console.log(`‚úÖ [${user.name}] Alerta creada: "${msg}"`);
                return;
              }
            } catch (error) {
              console.error("‚ùå Error al crear alerta:", error);
              return;
            }
          }
          
          // Comando: Eliminar alerta
          if (trimmed === '/clearalert') {
            try {
              await db.ref('system_alert').remove();
              setText("");
              console.log(`‚úÖ [${user.name}] Alerta eliminada`);
              return;
            } catch (error) {
              console.error("‚ùå Error al eliminar alerta:", error);
              return;
            }
          }
        }
        
        // Env√≠o de mensaje normal
        try {
          const messageData = {
            content: trimmed, 
            name: user.name, // Este es el nombre que se mostrar√°
            uid: user.uid, 
            color: user.isGod ? "#ffcc00" : (isDark ? "#fff" : "#000"), 
            isGod: user.isGod || false, 
            time: Date.now()
          };
          
          console.log("üì§ Enviando mensaje:", messageData);
          
          await db.ref(`messages/${chan}`).push(messageData);
          setText("");
          setShowEmoji(false);
        } catch (error) {
          console.error("‚ùå Error al enviar mensaje:", error);
          alert("Error al enviar el mensaje");
        }
      };

      const handleEmojiSelect = (emoji) => {
        setText(text + emoji);
        inputRef.current?.focus();
      };

      if (!user) {
        return (
          <div className="h-screen flex items-center justify-center p-6">
            <div className="card-3d p-10 text-center max-w-sm w-full border-t-2 border-red-600/50">
              <h1 className="font-['Orbitron'] text-4xl mb-10 font-black text-red-600 tracking-tighter">MUZZSNAP</h1>
              <button 
                onClick={login} 
                className={`w-full py-4 border-2 font-black rounded-2xl transition-all ${isDark ? 'border-red-600 text-red-600 hover:bg-red-600 hover:text-white' : 'border-black text-black hover:bg-black hover:text-white'}`}
              >
                INICIALIZAR
              </button>
              <div className="mt-8 flex justify-center">
                <div className="theme-toggle" onClick={() => setIsDark(!isDark)}>
                  <div className="circle"></div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      return (
        <div className="flex h-screen overflow-hidden p-2 lg:p-4 gap-4">
          {/* Overlay para cerrar men√∫ en mobile */}
          {isMenuOpen && (
            <div 
              className="sidebar-overlay lg:hidden" 
              onClick={() => setIsMenuOpen(false)}
            ></div>
          )}

          {/* Sidebar */}
          <aside className={`fixed lg:relative inset-y-0 left-0 z-[150] w-72 card-3d p-6 flex flex-col transition-all duration-300 ${isMenuOpen ? 'translate-x-4 opacity-100' : '-translate-x-full lg:translate-x-0 opacity-0 lg:opacity-100'}`}>
            <div className="flex justify-between items-center mb-10">
              <h1 className="font-['Orbitron'] text-xl font-black text-red-600">MUZZSNAP</h1>
              <div className="theme-toggle scale-75" onClick={() => setIsDark(!isDark)}>
                <div className="circle"></div>
              </div>
            </div>
            
            <div className="flex-1 overflow-y-auto space-y-8 scroll-container">
              <section>
                <p className="text-[10px] font-black mb-4 opacity-40 uppercase tracking-[0.2em]">Sectores</p>
                {['spanish', 'english'].map(c => (
                  <button 
                    key={c} 
                    onClick={() => {
                      setChan(c); 
                      setIsMenuOpen(false);
                    }} 
                    className={`w-full text-left p-4 rounded-2xl text-xs mb-2 capitalize font-black transition-all ${chan === c ? (isDark ? 'bg-red-600 text-white' : 'bg-black text-white') : 'opacity-40 hover:opacity-100'}`}
                  >
                    # {c} Core
                  </button>
                ))}
              </section>
              
              <section>
                <p className="text-[10px] font-black mb-4 opacity-40 uppercase tracking-[0.2em]">Unidades ({users.length})</p>
                <div className="space-y-3">
                  {users.map((u, i) => (
                    <div key={i} className="text-[11px] font-mono flex items-center gap-3">
                      <span className={`w-2 h-2 rounded-full flex-shrink-0 ${u.isGod ? 'bg-yellow-400 animate-pulse shadow-[0_0_8px_gold]' : 'bg-green-500'}`}></span>
                      <span className={`truncate ${u.isGod ? 'admin-glow' : 'font-bold opacity-80'}`}>
                        {u.isGod && 'üëë '}{u.name}
                      </span>
                    </div>
                  ))}
                </div>
              </section>
            </div>
            
            <div className="mt-6 pt-6 border-t border-gray-500/10 space-y-4">
              {/* BOT√ìN ADMIN: SOLO VISIBLE PARA ADMINISTRADORES */}
              {user.isGod && (
                <button 
                  onClick={() => setShowAdminPanel(true)} 
                  className="w-full py-3 bg-yellow-500/10 border border-yellow-500/40 text-yellow-500 text-[10px] font-black rounded-xl tracking-[0.2em] hover:bg-yellow-500/20 transition-all"
                >
                  ADMIN_INDEX
                </button>
              )}
              <button 
                onClick={() => window.location.reload()} 
                className="w-full text-[9px] font-black opacity-20 uppercase hover:opacity-100 transition-opacity"
              >
                Desconectar
              </button>
            </div>
          </aside>

          {/* Main Chat */}
          <main className="flex-1 card-3d flex flex-col overflow-hidden relative">
            {alertMsg && (
              <div className="alert-banner uppercase tracking-widest">
                ‚ö†Ô∏è ALERTA: {alertMsg} ‚ö†Ô∏è
              </div>
            )}
            
            <header className="h-16 p-5 border-b border-gray-500/10 flex justify-between items-center bg-black/5">
              <button 
                onClick={() => setIsMenuOpen(true)} 
                className="lg:hidden text-red-600 p-2 hover:bg-red-600/10 rounded-lg transition-all"
              >
                <i className="fas fa-bars text-xl"></i>
              </button>
              <span className="font-black uppercase text-xs text-red-600 tracking-[0.3em]">
                {chan}_link
              </span>
              <div className="w-10 lg:hidden"></div>
            </header>

            <div 
              className="flex-1 overflow-y-auto p-4 lg:p-8 flex flex-col gap-1 scroll-container" 
              onClick={() => setShowEmoji(false)}
            >
              {messages.length === 0 ? (
                <div className="flex-1 flex items-center justify-center opacity-30">
                  <p className="text-sm font-mono">No hay mensajes a√∫n...</p>
                </div>
              ) : (
                messages.map(m => (
                  <div 
                    key={m.id} 
                    className={`flex flex-col mb-4 ${m.uid === user.uid ? 'items-end' : 'items-start'}`}
                  >
                    <span className={`text-[10px] mb-1 px-2 font-bold ${m.isGod ? 'admin-glow' : 'opacity-40'}`}>
                      {m.isGod && 'üëë '}{m.name || 'Unknown'}
                    </span>
                    <div className={`bubble-3d shadow-md ${m.uid === user.uid ? 'me' : 'other'}`}>
                      {m.content}
                    </div>
                  </div>
                ))
              )}
              <div ref={scrollRef}></div>
            </div>

            <div className="p-4 lg:p-6 bg-black/5 relative">
              {showEmoji && (
                <div className="emoji-picker card-3d border shadow-2xl">
                  {EMOJI_LIST.map(e => (
                    <button 
                      key={e} 
                      onClick={() => handleEmojiSelect(e)} 
                      className="hover:scale-125 transition-transform p-1 cursor-pointer"
                    >
                      {e}
                    </button>
                  ))}
                </div>
              )}
              
              <div className={`flex gap-3 border rounded-2xl p-2 pl-4 transition-all ${isDark ? 'bg-black/60 border-white/10 shadow-inner' : 'bg-white border-gray-200'}`}>
                <button 
                  onClick={(e) => {
                    e.stopPropagation();
                    setShowEmoji(!showEmoji);
                  }} 
                  className="text-gray-400 hover:text-red-500 px-2 transition-colors flex-shrink-0"
                >
                  <i className="far fa-face-smile text-xl"></i>
                </button>
                <input 
                  ref={inputRef}
                  value={text} 
                  onChange={e => setText(e.target.value)} 
                  onKeyDown={e => e.key === 'Enter' && handleSend()} 
                  placeholder="Transmitir datos..." 
                  className="flex-1 bg-transparent outline-none text-sm font-medium" 
                  maxLength={500}
                />
                <button 
                  onClick={handleSend} 
                  className={`w-11 h-11 rounded-xl flex items-center justify-center transition-all flex-shrink-0 ${isDark ? 'bg-red-600 hover:bg-red-700' : 'bg-black text-white hover:bg-gray-800'}`}
                >
                  <i className="fas fa-bolt"></i>
                </button>
              </div>
            </div>
          </main>

          {/* PANEL DE ADMINISTRADOR: SOLO VISIBLE SI isGod === true */}
          {showAdminPanel && user.isGod && (
            <div className="fixed inset-0 z-[250] flex items-center justify-center bg-black/90 p-6 backdrop-blur-xl">
              <div className="card-3d max-w-md w-full p-8 relative border-yellow-500/50">
                <button 
                  onClick={() => setShowAdminPanel(false)} 
                  className="absolute top-6 right-6 opacity-40 hover:opacity-100 transition-opacity"
                >
                  <i className="fas fa-times text-xl"></i>
                </button>
                
                <h2 className="font-['Orbitron'] text-yellow-500 mb-8 text-center font-black tracking-widest text-lg">
                  SECURITY_CONSOLE
                </h2>
                
                <div className="space-y-4 font-mono text-[11px] text-gray-400">
                  <div className="p-4 bg-yellow-500/5 rounded-2xl border border-yellow-500/10">
                    <p className="text-yellow-500 font-bold mb-2 text-sm">/clear</p>
                    <p className="leading-relaxed">Elimina todo el historial de mensajes del sector actual.</p>
                  </div>
                  
                  <div className="p-4 bg-yellow-500/5 rounded-2xl border border-yellow-500/10">
                    <p className="text-yellow-500 font-bold mb-2 text-sm">/alert [mensaje]</p>
                    <p className="leading-relaxed">Crea una alerta de emergencia visible para todos los usuarios.</p>
                    <p className="mt-2 text-[10px] opacity-60">Ejemplo: /alert Sistema en mantenimiento</p>
                  </div>
                  
                  <div className="p-4 bg-yellow-500/5 rounded-2xl border border-yellow-500/10">
                    <p className="text-yellow-500 font-bold mb-2 text-sm">/clearalert</p>
                    <p className="leading-relaxed">Elimina la alerta de emergencia activa.</p>
                  </div>
                </div>
                
                <div className="mt-6 p-4 bg-red-500/5 border border-red-500/20 rounded-xl">
                  <p className="text-red-500 font-bold text-[10px] uppercase tracking-wider mb-2">‚ö†Ô∏è Confidencial</p>
                  <p className="text-[10px] leading-relaxed opacity-60">
                    Estos comandos son exclusivos para administradores y no son visibles para usuarios regulares.
                  </p>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
