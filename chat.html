<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>MuzzSnap - Terminal Edition</title>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body, #root { height:100%; }
    body { font-family:'Orbitron',monospace; transition:background 0.3s, color 0.3s; }
    .dark-theme { background:#0a0a0a; color:#fff; }
    .light-theme { background:#f5f5f5; color:#000; }
    .panel-3d { background:rgba(20,20,20,0.8); border:1px solid rgba(255,255,255,0.08); border-radius:20px; box-shadow:0 8px 32px rgba(0,0,0,0.5); backdrop-filter:blur(20px); }
    .light-theme .panel-3d { background:rgba(255,255,255,0.95); border:1px solid rgba(0,0,0,0.08); }
    .bubble-3d { max-width:70%; padding:14px 20px; border-radius:18px; font-size:13px; word-wrap:break-word; position:relative; animation:slideIn 0.2s; }
    @keyframes slideIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
    .bubble-3d.me { background:linear-gradient(135deg,#c41e3a,#8b0000); color:#fff; text-align:right; box-shadow:0 4px 20px rgba(196,30,58,0.4); }
    .bubble-3d.other { background:rgba(40,40,40,0.95); color:#e0e0e0; box-shadow:0 4px 15px rgba(0,0,0,0.5); border:1px solid rgba(255,255,255,0.05); }
    .light-theme .bubble-3d.other { background:rgba(255,255,255,0.98); color:#333; box-shadow:0 4px 15px rgba(0,0,0,0.1); border:1px solid rgba(0,0,0,0.08); }
    .bubble-3d.muted { opacity:0.4; }
    
    /* NUEVOS ESTILOS PARA MENSAJES PRIVADOS - SOLO A√ëADIDOS, NO SE CAMBI√ì NADA */
    .bubble-3d.private { background:linear-gradient(135deg,#0066cc,#0052a3) !important; color:#fff !important; box-shadow:0 4px 20px rgba(0,102,204,0.5) !important; border:1px solid rgba(0,153,255,0.3) !important; }
    .bubble-3d.private::before { content:'üîí'; position:absolute; top:2px; right:6px; font-size:10px; opacity:0.8; }
    .user-clickable { cursor:pointer; transition:all 0.2s; }
    .user-clickable:hover { background:rgba(0,102,204,0.1); padding-left:8px; }
    .user-selected { background:rgba(0,102,204,0.2); border-left:2px solid #0066cc; }
    .dm-indicator { background:#0066cc; color:#fff; font-size:8px; padding:2px 6px; border-radius:8px; font-weight:900; margin-left:auto; }
    .private-mode-header { background:rgba(0,102,204,0.1); border-bottom:1px solid rgba(0,102,204,0.3); }
    
    .online-indicator { width:6px; height:6px; background:#00ff00; border-radius:50%; box-shadow:0 0 8px #00ff00; animation:pulse 2s infinite; }
    @keyframes pulse { 0%, 100% { opacity:1; } 50% { opacity:0.5; } }
    .ryachu-name { background:linear-gradient(45deg,gold,#ff6b35); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; filter:drop-shadow(0 0 10px rgba(255,215,0,0.5)); }
    .itsuki-name { background:linear-gradient(45deg,#00d4ff,#b19cd9); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; filter:drop-shadow(0 0 10px rgba(0,212,255,0.5)); }
    .admin-btn { padding:8px; font-size:9px; text-transform:uppercase; font-weight:900; letter-spacing:0.1em; background:rgba(220,38,38,0.1); border:1px solid rgba(220,38,38,0.3); color:#dc2626; border-radius:8px; cursor:pointer; transition:all 0.2s; }
    .admin-btn:hover { background:rgba(220,38,38,0.2); box-shadow:0 0 15px rgba(220,38,38,0.3); }
    .hacker-input { outline:none; color:#fff; }
    .light-theme .hacker-input { color:#000; }
    .custom-scroll::-webkit-scrollbar { width:6px; height:6px; }
    .custom-scroll::-webkit-scrollbar-track { background:rgba(255,255,255,0.05); border-radius:10px; }
    .custom-scroll::-webkit-scrollbar-thumb { background:rgba(220,38,38,0.4); border-radius:10px; }
    .custom-scroll::-webkit-scrollbar-thumb:hover { background:rgba(220,38,38,0.7); }
    .emoji-window { display:grid; grid-template-columns:repeat(8,1fr); gap:8px; padding:16px; max-height:220px; overflow-y:auto; }
    .emoji-btn { font-size:24px; cursor:pointer; text-align:center; padding:8px; border-radius:8px; transition:all 0.15s; }
    .emoji-btn:hover { background:rgba(220,38,38,0.1); transform:scale(1.2); }
  </style>
</head>
<body class="dark-theme">
  <div id="root" class="h-full"></div>

  <script type="text/babel">
    const{useState:_0xa1,useEffect:_0xa2,useRef:_0xa3}=React;
    
    // ============ CLASE E2EE - NUEVA FUNCIONALIDAD ============
    class E2EECrypto {
      constructor() {
        this.keyPair = null;
        this.sharedSecrets = new Map();
      }
      async initialize() {
        this.keyPair = await window.crypto.subtle.generateKey(
          {name:"ECDH",namedCurve:"P-256"},false,["deriveKey","deriveBits"]
        );
        const exported = await window.crypto.subtle.exportKey("raw",this.keyPair.publicKey);
        return btoa(String.fromCharCode(...new Uint8Array(exported)));
      }
      async importPublicKey(base64Key) {
        const binary = atob(base64Key);
        const bytes = new Uint8Array(binary.length);
        for(let i=0;i<binary.length;i++)bytes[i]=binary.charCodeAt(i);
        return await window.crypto.subtle.importKey("raw",bytes,{name:"ECDH",namedCurve:"P-256"},false,[]);
      }
      async deriveSharedSecret(otherPublicKey) {
        const bits = await window.crypto.subtle.deriveBits({name:"ECDH",public:otherPublicKey},this.keyPair.privateKey,256);
        return await window.crypto.subtle.importKey("raw",bits,{name:"AES-GCM"},false,["encrypt","decrypt"]);
      }
      async encryptMessage(message,recipientUserId) {
        const sharedSecret = this.sharedSecrets.get(recipientUserId);
        if(!sharedSecret)throw new Error("No shared secret");
        const iv = window.crypto.getRandomValues(new Uint8Array(12));
        const encoded = new TextEncoder().encode(message);
        const encrypted = await window.crypto.subtle.encrypt({name:"AES-GCM",iv},sharedSecret,encoded);
        return {
          ciphertext:btoa(String.fromCharCode(...new Uint8Array(encrypted))),
          iv:btoa(String.fromCharCode(...new Uint8Array(iv)))
        };
      }
      async decryptMessage(encryptedData,senderUserId) {
        const sharedSecret = this.sharedSecrets.get(senderUserId);
        if(!sharedSecret)throw new Error("No shared secret");
        const ciphertext = Uint8Array.from(atob(encryptedData.ciphertext),c=>c.charCodeAt(0));
        const iv = Uint8Array.from(atob(encryptedData.iv),c=>c.charCodeAt(0));
        const decrypted = await window.crypto.subtle.decrypt({name:"AES-GCM",iv},sharedSecret,ciphertext);
        return new TextDecoder().decode(decrypted);
      }
    }
    
    const _0xfb={apiKey:atob('QUl6YVN5QWUxLUpmTmRlME5LSU1kRTdwaGZFWGxtOUphcVVIMGpZ'),authDomain:atob('cHVsc2FyaS5maXJlYmFzZWFwcC5jb20='),databaseURL:atob('aHR0cHM6Ly9wdWxzYXJpLWRlZmF1bHQtcnRkYi5maXJlYmFzZWlvLmNvbQ=='),projectId:atob('cHVsc2FyaQ=='),storageBucket:atob('cHVsc2FyaS5maXJlYmFzZXN0b3JhZ2UuYXBw'),messagingSenderId:atob('ODI0MzA2MzIxMjMz'),appId:atob('MTo4MjQzMDYzMjEyMzM6d2ViOjJjOWJmYTAyMTcwYTE3ZDU2MGI1NzA=')};
    if(!firebase.apps.length)firebase.initializeApp(_0xfb);
    const _0xdb=firebase.database();
    const _0xad={R:atob('MHgyMDgxNTdiNWVjMzk2NzU5ZTg3NTQwNTgxMDhlY2Y1M2UzMjM5MmZm').toLowerCase(),I:atob('MHhmYWI1ODM1Y2ExNGZiM2Y5Zjk3OGM1ZTRkNzMzNzM0ZTYzOTRlMDNm').toLowerCase()};
    const _0xem={"FACES":["üòä","üòÇ","üòâ","üòç","üòò","üòõ","üòÖ","üò¢","üò≠","üò†","üòà","üëΩ","ü§ñ","ü§°","üíÄ","üëª","üí©"],"HANDS":["üëç","üëé","üëå","‚úåÔ∏è","üëè","üëã","üôè","üí™","‚òùÔ∏è","üññ"],"OBJECTS":["‚ù§Ô∏è","‚≠ê","üî•","üìö","üíª","üì±","üì∑","üîë","üîí","üí°","üí∞","üíé"],"NATURE":["‚òÄÔ∏è","‚òÅÔ∏è","üåà","üå≥","üå∏","üåµ","üê±","üê∂","ü¶Å","ü¶Ñ","üêâ","üêç"],"FOOD":["üçï","üçî","üåÆ","üç£","üç∞","üç¶","‚òï","üç∫","üç∑","üç∏"],"ACTIVITIES":["‚öΩ","üèÄ","üéæ","üéµ","üé∏","üéÆ","‚ôüÔ∏è","üé®","üé¨"]};
    const _0xch=[{id:"general",name:"GENERAL"},{id:"spanish",name:"ESPA√ëOL"},{id:"dao",name:"DAO"}];
    
    function App(){
      const[_0xb1,_0xb2]=_0xa1(null);
      const[_0xb3,_0xb4]=_0xa1([]);
      const[_0xb5,_0xb6]=_0xa1([]);
      const[_0xb7,_0xb8]=_0xa1({});
      const[_0xb9,_0xc0]=_0xa1("");
      const[_0xc1,_0xc2]=_0xa1("");
      const[_0xc3,_0xc4]=_0xa1(true);
      const[_0xc5,_0xc6]=_0xa1(false);
      const[_0xc7,_0xc8]=_0xa1("FACES");
      const[_0xc9,_0xd0]=_0xa1(_0xch[0]);
      const[_0xd1,_0xd2]=_0xa1(false);
      const[_0xd3,_0xd4]=_0xa1(null);
      const[_0xd5,_0xd6]=_0xa1(false);
      const[_0xd7,_0xd8]=_0xa1(false);
      const[_0xd9,_0xe0]=_0xa1(false);
      
      // ============ NUEVOS ESTADOS PARA MENSAJES PRIVADOS ============
      const[_0xpm,_0xpmSet]=_0xa1(null); // Usuario privado seleccionado
      const[_0xpms,_0xpmsSet]=_0xa1({}); // Mensajes privados
      const[_0xcrypto,_0xcryptoSet]=_0xa1(null); // Instancia E2EE
      const[_0xpubKeys,_0xpubKeysSet]=_0xa1({}); // Claves p√∫blicas
      const[_0xunread,_0xunreadSet]=_0xa1({}); // Mensajes no le√≠dos
      
      const _0xe1=_0xa3(null);
      const _0xe2=()=>{_0xc4(!_0xc3);document.body.className=_0xc3?'light-theme':'dark-theme';};
      
      _0xa2(()=>{
        const _0xe3=sessionStorage.getItem('muzz_wallet_address');
        if(!_0xe3){window.location.href='login.html';return;}
        firebase.auth().signInAnonymously().then(async(_0xe4)=>{
          const _0xe5=_0xe4.user.uid;
          const _0xe6=!_0xe3.startsWith('guest_');
          let _0xe7="",_0xe8="user";
          if(_0xe6){
            const _0xe9=_0xe3.toLowerCase();
            if(_0xe9===_0xad.R){_0xe7="Ryachu";_0xe8="ryachu";}
            else if(_0xe9===_0xad.I){_0xe7="Itsuki";_0xe8="itsuki";}
            else{_0xe7=`Node_${_0xe3.slice(-4)}`;}
          }else{_0xe7=_0xe3.replace('guest_','');_0xe8="guest";}
          
          _0xb2({username:_0xe7,uid:_0xe5,role:_0xe8,isWallet:_0xe6});
          
          // ============ INICIALIZAR E2EE SOLO PARA WALLETS ============
          if(_0xe6){
            try{
              const crypto = new E2EECrypto();
              const pubKey = await crypto.initialize();
              _0xcryptoSet(crypto);
              await _0xdb.ref(`publicKeys/${_0xe5}`).set(pubKey);
              _0xdb.ref('publicKeys').on('value',snap=>_0xpubKeysSet(snap.val()||{}));
            }catch(err){console.error("E2EE error:",err);}
          }
          
          _0xdb.ref(`status/${_0xe5}`).onDisconnect().remove();
          _0xdb.ref(`status/${_0xe5}`).set({username:_0xe7,role:_0xe8,uid:_0xe5,isWallet:_0xe6});
          _0xdb.ref('status').on('value',_0xf0=>_0xb6(_0xf0.val()?Object.values(_0xf0.val()):[]));
          _0xdb.ref('settings/pinned').on('value',_0xf1=>_0xc0(_0xf1.val()||""));
          _0xdb.ref('muted').on('value',_0xf2=>_0xb8(_0xf2.val()||{}));
        });
      },[]);
      
      // ============ DERIVAR CLAVES COMPARTIDAS ============
      _0xa2(()=>{
        if(!_0xcrypto||!_0xb1||!_0xb1.isWallet)return;
        (async()=>{
          for(const[userId,pubKeyBase64]of Object.entries(_0xpubKeys)){
            if(userId===_0xb1.uid||_0xcrypto.sharedSecrets.has(userId))continue;
            try{
              const otherPubKey = await _0xcrypto.importPublicKey(pubKeyBase64);
              const sharedSecret = await _0xcrypto.deriveSharedSecret(otherPubKey);
              _0xcrypto.sharedSecrets.set(userId,sharedSecret);
            }catch(err){console.error("Derive key error:",err);}
          }
        })();
      },[_0xpubKeys,_0xcrypto,_0xb1]);
      
      _0xa2(()=>{
        if(!_0xb1)return;
        const _0xf3=_0xdb.ref('messages/'+_0xc9.id).limitToLast(50);
        _0xf3.on('value',_0xf4=>{
          const _0xf5=_0xf4.val();
          _0xb4(_0xf5?Object.keys(_0xf5).map(_0xf6=>({id:_0xf6,..._0xf5[_0xf6]})):[]);
        });
        return()=>_0xf3.off();
      },[_0xc9,_0xb1]);
      
      // ============ ESCUCHAR MENSAJES PRIVADOS ============
      _0xa2(()=>{
        if(!_0xb1||!_0xb1.isWallet||!_0xcrypto)return;
        const pmRef = _0xdb.ref('privateMessages');
        pmRef.on('value',async(snap)=>{
          const data = snap.val();
          if(!data){_0xpmsSet({});return;}
          const pms = {};
          const now = Date.now();
          const day24h = 24*60*60*1000;
          for(const[msgId,msg]of Object.entries(data)){
            // Eliminar mensajes mayores a 24h
            if(now - msg.timestamp > day24h){
              _0xdb.ref(`privateMessages/${msgId}`).remove();
              continue;
            }
            const parts = msg.participants?.split('_').sort()||[];
            if(!parts.includes(_0xb1.uid))continue;
            const otherUserId = parts.find(id=>id!==_0xb1.uid);
            if(!otherUserId)continue;
            if(!pms[otherUserId])pms[otherUserId]=[];
            try{
              let content = msg.content;
              if(msg.encrypted){
                content = await _0xcrypto.decryptMessage(
                  {ciphertext:msg.content,iv:msg.iv},
                  msg.senderId
                );
              }
              pms[otherUserId].push({...msg,content,id:msgId});
            }catch(err){
              pms[otherUserId].push({...msg,content:"üîí[Error]",id:msgId});
            }
          }
          Object.keys(pms).forEach(uid=>{
            pms[uid].sort((a,b)=>a.timestamp-b.timestamp);
          });
          _0xpmsSet(pms);
          const unreads = {};
          Object.entries(pms).forEach(([uid,msgs])=>{
            if(uid!==_0xpm?.uid){
              const cnt = msgs.filter(m=>m.senderId!==_0xb1.uid&&!m.read).length;
              if(cnt>0)unreads[uid]=cnt;
            }
          });
          _0xunreadSet(unreads);
        });
        return()=>pmRef.off();
      },[_0xb1,_0xcrypto,_0xpm]);
      
      // ============ MARCAR COMO LE√çDO ============
      _0xa2(()=>{
        if(!_0xpm||!_0xpms[_0xpm.uid])return;
        _0xpms[_0xpm.uid].forEach(msg=>{
          if(msg.senderId!==_0xb1.uid&&!msg.read){
            _0xdb.ref(`privateMessages/${msg.id}/read`).set(true);
          }
        });
        _0xunreadSet(prev=>{
          const n={...prev};
          delete n[_0xpm.uid];
          return n;
        });
      },[_0xpm,_0xpms,_0xb1]);
      
      _0xa2(()=>{
        _0xe1.current?.scrollIntoView({behavior:'smooth'});
      },[_0xb3,_0xpms]);
      
      const _0xf7=async()=>{
        if(!_0xc1.trim())return;
        if(_0xb7[_0xb1.uid]&&_0xb7[_0xb1.uid]>Date.now()){
          alert("Est√°s silenciado temporalmente");return;
        }
        if(_0xd5&&_0xf8){
          _0xdb.ref('settings/pinned').set(_0xc1);
          _0xd6(false);_0xc2("");return;
        }
        
        // ============ ENVIAR MENSAJE PRIVADO E2EE ============
        if(_0xpm){
          if(!_0xb1.isWallet){
            alert("‚ö†Ô∏è Mensajes privados solo con wallet crypto");
            return;
          }
          try{
            const encrypted = await _0xcrypto.encryptMessage(_0xc1,_0xpm.uid);
            const participants = [_0xb1.uid,_0xpm.uid].sort().join('_');
            await _0xdb.ref('privateMessages').push({
              content:encrypted.ciphertext,
              iv:encrypted.iv,
              encrypted:true,
              senderId:_0xb1.uid,
              senderName:_0xb1.username,
              recipientId:_0xpm.uid,
              participants,
              timestamp:Date.now(),
              read:false
            });
          }catch(err){
            alert("‚ùå Error al encriptar");
            return;
          }
        }else{
          _0xdb.ref('messages/'+_0xc9.id).push({
            content:_0xc1,
            username:_0xb1.username,
            role:_0xb1.role,
            userId:_0xb1.uid,
            timestamp:Date.now()
          });
        }
        _0xc2("");_0xc6(false);
      };
      
      const _0xf9={
        clearChat:()=>{if(confirm("¬øBorrar todo el historial del chat?")){_0xdb.ref('messages/'+_0xc9.id).remove();}},
        enablePinMode:()=>{_0xd6(true);_0xc2("");},
        removePin:()=>_0xdb.ref('settings/pinned').remove(),
        openBanPanel:()=>_0xd8(true),
        openMutePanel:()=>_0xe0(true),
        banUser:(_0xg0,_0xg1)=>{if(confirm(`¬øBanear permanentemente a ${_0xg1}?`)){_0xdb.ref(`banned/${_0xg0}`).set(true);_0xdb.ref(`status/${_0xg0}`).remove();}_0xd8(false);},
        muteUser:(_0xg2,_0xg3)=>{const _0xg4=Date.now()+60000;_0xdb.ref(`muted/${_0xg2}`).set(_0xg4);setTimeout(()=>_0xdb.ref(`muted/${_0xg2}`).remove(),60000);alert(`${_0xg3} ha sido silenciado por 1 minuto`);_0xe0(false);}
      };
      
      // ============ SELECCIONAR USUARIO PARA MENSAJE PRIVADO ============
      const selectPrivateUser = (user) => {
        if(user.uid===_0xb1.uid)return;
        if(!_0xb1.isWallet){
          alert("‚ö†Ô∏è Mensajes privados solo disponibles con wallet crypto");
          return;
        }
        if(!user.isWallet){
          alert(`‚ö†Ô∏è ${user.username} no tiene wallet crypto`);
          return;
        }
        _0xpmSet(user);
        _0xd2(false);
      };
      
      const _0xf8=_0xb1&&(_0xb1.role==='ryachu'||_0xb1.role==='itsuki');
      
      if(!_0xb1)return <div className="h-full flex items-center justify-center text-red-600 font-orbitron animate-pulse">CONNECTING...</div>;
      
      // ============ MENSAJES A MOSTRAR ============
      const displayMessages = _0xpm ? (_0xpms[_0xpm.uid]||[]) : _0xb3;
      const totalUnread = Object.values(_0xunread).reduce((a,b)=>a+b,0);
      
      return(<div className="flex h-screen p-2 md:p-4 lg:p-6 gap-4 md:gap-6 max-w-[1600px] mx-auto overflow-hidden"><aside className={`fixed lg:relative z-50 inset-y-0 left-0 w-72 lg:w-64 transition-all duration-300 transform panel-3d p-6 flex flex-col ${_0xd1?'translate-x-0':'-translate-x-full lg:translate-x-0 shadow-2xl lg:shadow-none'}`}><div className="mb-8 flex items-center gap-3"><div className="w-10 h-10 bg-red-600 rounded-xl flex items-center justify-center shadow-lg shadow-red-600/30"><i className="fas fa-ghost text-white text-sm"></i></div><h1 className="font-orbitron font-black text-xl italic tracking-tighter">MUZZ<span className="text-red-600">SNAP</span></h1></div><div className="flex-1 overflow-y-auto custom-scroll space-y-8 pr-2">{_0xf8&&(<div><p className="text-[9px] text-red-600 font-bold tracking-[0.3em] mb-4 uppercase">Admin Console</p><div className="grid grid-cols-2 gap-2 mb-3"><button onClick={_0xf9.enablePinMode}className="admin-btn"><i className="fas fa-thumbtack mr-1"></i>FIJAR</button><button onClick={_0xf9.clearChat}className="admin-btn"><i className="fas fa-trash mr-1"></i>LIMPIAR</button></div><details className="bg-red-600/5 border border-red-600/20 rounded-lg"><summary className="cursor-pointer px-3 py-2 text-[9px] font-bold text-red-500 uppercase tracking-wider">Moderaci√≥n ‚ñº</summary><div className="p-3 space-y-2 border-t border-red-600/20"><button onClick={()=>_0xf9.openBanPanel()}className="w-full admin-btn text-left"><i className="fas fa-user-slash mr-2"></i>Banear Usuario</button><button onClick={()=>_0xf9.openMutePanel()}className="w-full admin-btn text-left"><i className="fas fa-volume-mute mr-2"></i>Mutear 1min</button></div></details></div>)}<div><p className="text-[10px] text-gray-500 font-bold tracking-[0.3em] mb-4 uppercase">Channels</p>{_0xch.map(_0xg5=>(<button key={_0xg5.id}onClick={()=>{_0xd0(_0xg5);_0xpmSet(null);_0xd2(false);}}className={`w-full text-left px-4 py-3 rounded-xl text-xs font-bold mb-1 transition-all ${_0xc9.id===_0xg5.id&&!_0xpm?'bg-red-600/10 text-red-600 border-l-2 border-red-600 shadow-lg shadow-red-600/5':'text-gray-500 hover:text-white'}`}># {_0xg5.name}</button>))}</div><div><p className="text-[10px] text-gray-500 font-bold tracking-[0.3em] mb-4 uppercase">Online ‚Äî {_0xb5.length}</p><div className="space-y-3">{_0xb5.map((_0xg6,_0xg7)=>{
        const isMe=_0xg6.uid===_0xb1.uid;
        const isSel=_0xpm?.uid===_0xg6.uid;
        const unreadCnt=_0xunread[_0xg6.uid]||0;
        const canDM=!isMe&&_0xg6.isWallet&&_0xb1.isWallet;
        return(<div key={_0xg7}onClick={()=>canDM&&selectPrivateUser(_0xg6)}className={`flex items-center gap-3 px-2 ${canDM?'user-clickable':''} ${isSel?'user-selected':''}`}><span className="online-indicator"></span><span className={`text-[11px] truncate font-bold uppercase flex-1 ${_0xg6.role==='ryachu'?'ryachu-name':_0xg6.role==='itsuki'?'itsuki-name':'text-gray-400'}`}>{_0xg6.role==='ryachu'&&'üëë '}{_0xg6.role==='itsuki'&&'üíé '}{_0xg6.username}{isMe&&' (t√∫)'}</span>{unreadCnt>0&&<span className="dm-indicator">{unreadCnt}</span>}{_0xg6.isWallet&&!isMe&&<i className="fas fa-lock text-blue-400 text-[8px]"></i>}</div>);})}</div></div></div><button onClick={()=>{sessionStorage.clear();window.location.href='login.html'}}className="mt-6 w-full py-3 text-[10px] border border-red-900/30 text-red-600 rounded-xl uppercase font-black tracking-widest hover:bg-red-600/5 transition-all"><i className="fas fa-power-off mr-2"></i>Disconnect</button></aside><main className="flex-1 panel-3d flex flex-col overflow-hidden border border-white/5 h-full relative">{_0xb9&&!_0xpm&&(<div className="bg-red-600/10 border-b border-red-600/30 py-2 px-6 flex items-center gap-4 flex-shrink-0"><i className="fas fa-thumbtack text-red-600 text-[10px] animate-pulse"></i><marquee className="text-[10px] font-bold tracking-[0.2em] text-red-500 uppercase flex-1">{_0xb9}</marquee>{_0xf8&&(<button onClick={_0xf9.removePin}className="text-[8px] text-red-400 hover:text-red-600"><i className="fas fa-times"></i></button>)}</div>)}<header className={`h-16 flex items-center justify-between px-8 bg-white/5 border-b border-white/5 flex-shrink-0 ${_0xpm?'private-mode-header':''}`}><div className="flex items-center gap-4"><button onClick={()=>_0xd2(true)}className="lg:hidden text-red-600"><i className="fas fa-bars"></i></button><h2 className="text-sm font-black tracking-[0.2em] uppercase italic">{_0xpm?<span className="text-blue-400"><i className="fas fa-lock mr-2"></i>PRIVATE: {_0xpm.username}</span>:<span className="text-red-600">/ {_0xc9.name}</span>}</h2>{_0xpm&&<button onClick={()=>_0xpmSet(null)}className="text-[9px] text-gray-500 hover:text-red-600"><i className="fas fa-times mr-1"></i>Cerrar</button>}</div><button onClick={_0xe2}className="w-10 h-10 rounded-xl border border-red-600/20 flex items-center justify-center hover:bg-red-600/5 transition-all">{_0xc3?<i className="fas fa-sun text-yellow-500"></i>:<i className="fas fa-moon text-blue-500"></i>}</button></header><div className="flex-1 overflow-y-auto p-4 md:p-8 flex flex-col gap-5 custom-scroll">{displayMessages.map((_0xg8,_0xg9)=>{const _0xh0=_0xb7[_0xg8.userId]&&_0xb7[_0xg8.userId]>Date.now();const _0xh1=new Date(_0xg8.timestamp);const _0xh2=_0xg9>0?displayMessages[_0xg9-1]:null;const _0xh3=_0xh2?new Date(_0xh2.timestamp):null;const _0xh4=!_0xh3||_0xh1.toDateString()!==_0xh3.toDateString();const _0xh5=(_0xh6)=>{const _0xh7=new Date();const _0xh8=new Date(_0xh7);_0xh8.setDate(_0xh8.getDate()-1);if(_0xh6.toDateString()===_0xh7.toDateString()){return'HOY';}else if(_0xh6.toDateString()===_0xh8.toDateString()){return'AYER';}else{return _0xh6.toLocaleDateString('es-ES',{weekday:'long',year:'numeric',month:'long',day:'numeric'}).toUpperCase();}};const isMyMsg=_0xpm?_0xg8.senderId===_0xb1.uid:_0xg8.userId===_0xb1.uid;const dispName=_0xpm?(_0xg8.senderId===_0xb1.uid?_0xb1.username:_0xpm.username):_0xg8.username;const userRole=_0xpm?(_0xg8.senderId===_0xb1.uid?_0xb1.role:'user'):_0xg8.role;return(<React.Fragment key={_0xg8.id}>{_0xh4&&(<div className="flex items-center gap-4 my-4"><div className="flex-1 h-px bg-gradient-to-r from-transparent via-red-600/30 to-transparent"></div><span className="text-[9px] font-black tracking-[0.3em] text-red-600/70 px-4 py-1.5 bg-red-600/5 rounded-full border border-red-600/20">{_0xh5(_0xh1)}</span><div className="flex-1 h-px bg-gradient-to-r from-red-600/30 via-transparent to-transparent"></div></div>)}<div className={`flex flex-col ${isMyMsg?'items-end':'items-start'}`}><span className={`text-[10px] font-black mb-1.5 uppercase px-2 ${userRole==='ryachu'?'ryachu-name':userRole==='itsuki'?'itsuki-name':_0xpm?'text-blue-400':'text-gray-500'}`}>{userRole==='ryachu'&&'üëë '}{userRole==='itsuki'&&'üíé '}{dispName} {_0xh0&&'üîá'}</span><div className={`bubble-3d shadow-xl ${isMyMsg?'me':'other'} ${_0xh0?'muted':''} ${_0xpm?'private':''}`}>{_0xg8.content}</div></div></React.Fragment>);})}<div ref={_0xe1}></div></div><div className={`p-4 md:p-6 ${_0xc3?'bg-black/40':'bg-gray-50'} border-t border-white/5 flex-shrink-0`}>{totalUnread>0&&!_0xpm&&(<div onClick={()=>{const firstUnreadUser=Object.keys(_0xunread)[0];const user=_0xb5.find(u=>u.uid===firstUnreadUser);if(user)selectPrivateUser(user);}} className="mb-3 px-4 py-2 bg-blue-600/10 border border-blue-600/30 rounded-lg text-blue-400 text-xs font-bold flex items-center gap-2 cursor-pointer hover:bg-blue-600/20"><i className="fas fa-envelope animate-pulse"></i>Tienes {totalUnread} mensaje{totalUnread>1?'s':''} privado{totalUnread>1?'s':''} - Toca para ver</div>)}{_0xd5&&(<div className="mb-3 px-4 py-2 bg-yellow-500/10 border border-yellow-500/30 rounded-lg text-yellow-500 text-xs font-bold flex items-center gap-2"><i className="fas fa-thumbtack animate-pulse"></i>MODO FIJAR MENSAJE ACTIVADO - Escribe y env√≠a<button onClick={()=>_0xd6(false)}className="ml-auto text-yellow-500 hover:text-yellow-300"><i className="fas fa-times"></i></button></div>)}{_0xd7&&(<div className="mb-3 panel-3d border border-red-600/30 p-4 max-h-48 overflow-y-auto custom-scroll"><div className="flex justify-between items-center mb-3"><p className="text-xs font-bold text-red-500 uppercase">Seleccionar usuario para banear</p><button onClick={()=>_0xd8(false)}className="text-gray-500 hover:text-red-500"><i className="fas fa-times"></i></button></div>{_0xb5.filter(_0xh9=>_0xh9.role!=='ryachu'&&_0xh9.role!=='itsuki').map(_0xi0=>(<button key={_0xi0.uid}onClick={()=>_0xf9.banUser(_0xi0.uid,_0xi0.username)}className="w-full text-left px-3 py-2 text-xs hover:bg-red-600/10 rounded mb-1 flex items-center gap-2"><i className="fas fa-user-slash text-red-500"></i><span className="font-bold">{_0xi0.username}</span></button>))}</div>)}{_0xd9&&(<div className="mb-3 panel-3d border border-yellow-600/30 p-4 max-h-48 overflow-y-auto custom-scroll"><div className="flex justify-between items-center mb-3"><p className="text-xs font-bold text-yellow-500 uppercase">Seleccionar usuario para mutear</p><button onClick={()=>_0xe0(false)}className="text-gray-500 hover:text-yellow-500"><i className="fas fa-times"></i></button></div>{_0xb5.filter(_0xi1=>_0xi1.role!=='ryachu'&&_0xi1.role!=='itsuki').map(_0xi2=>(<button key={_0xi2.uid}onClick={()=>_0xf9.muteUser(_0xi2.uid,_0xi2.username)}className="w-full text-left px-3 py-2 text-xs hover:bg-yellow-600/10 rounded mb-1 flex items-center gap-2"><i className="fas fa-volume-mute text-yellow-500"></i><span className="font-bold">{_0xi2.username}</span></button>))}</div>)}{_0xc5&&(<div className={`mb-4 panel-3d border border-red-600/20 overflow-hidden shadow-2xl h-auto flex-shrink-0`}><div className="flex bg-black/10 border-b border-white/5 overflow-x-auto custom-scroll">{Object.keys(_0xem).map(_0xi3=>(<button key={_0xi3}onClick={()=>_0xc8(_0xi3)}className={`px-4 py-2 text-[9px] font-black uppercase tracking-tighter ${_0xc7===_0xi3?'text-red-600 bg-red-600/5':'text-gray-500'}`}>{_0xi3}</button>))}</div><div className="emoji-window custom-scroll">{_0xem[_0xc7].map(_0xi4=>(<span key={_0xi4}onClick={()=>_0xc2(_0xc1+_0xi4)}className="emoji-btn">{_0xi4}</span>))}</div></div>)}<div className="flex items-center bg-black/30 border border-white/10 rounded-2xl p-2.5 pl-5 focus-within:border-red-600/50 transition-all shadow-inner"><button onClick={()=>_0xc6(!_0xc5)}className="text-gray-500 hover:text-red-600 transition-colors mr-3"><i className="far fa-laugh-beam text-xl"></i></button><input value={_0xc1}onChange={_0xi5=>_0xc2(_0xi5.target.value)}onKeyDown={_0xi6=>_0xi6.key==='Enter'&&_0xf7()}placeholder={_0xd5?"Escribe el mensaje a fijar...":_0xpm?"üîí Mensaje privado E2EE...":_0xb7[_0xb1.uid]&&_0xb7[_0xb1.uid]>Date.now()?"Est√°s silenciado...":"Transmit message..."}disabled={_0xb7[_0xb1.uid]&&_0xb7[_0xb1.uid]>Date.now()}className="flex-1 bg-transparent border-none focus:ring-0 text-sm hacker-input"/><button onClick={_0xf7}className={`w-12 h-12 ${_0xd5?'bg-yellow-600':_0xpm?'bg-blue-600':'bg-red-600'} rounded-xl flex items-center justify-center hover:bg-red-500 active:scale-95 transition-all shadow-[0_0_20px_rgba(255,0,0,0.3)]`}><i className={`fas ${_0xd5?'fa-thumbtack':_0xpm?'fa-lock':'fa-paper-plane'} text-white`}></i></button></div></div></main>{_0xd1&&<div onClick={()=>_0xd2(false)}className="fixed inset-0 bg-black/90 z-40 lg:hidden backdrop-blur-md"></div>}</div>);
    }
    
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
